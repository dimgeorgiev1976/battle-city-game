<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Battle city</title>
</head>
<body>
    <script src="engine/DisplayObject.js"></script>
    <script src="engine/Container.js"></script>
    <script src="engine/Loader.js"></script>
    <script src="engine/Renderer.js"></script>
    <script src="engine/Sprite.js"></script>
    <script src="engine/Scene.js"></script>
    <script src="engine/Game.js"></script>
        

     <script>

        const { Loader, Renderer , Sprite, Container, Game, Scene } = GameEngine

        let sprite1 = null
        let sprite2 = null
        let sprite3 = null
        let sprite4 = null
        let container = null
        let container1 = null
        // Создадем екземпляръй классу
        const loader = new Loader
        const renderer = new Renderer ({
            // Настройка размера canvas
            width: 500,
            height: 500,
            background: 'gray',
           
           
            // Функция каторая въйзеваться при каждом обновление tick
            update (timestamp) {
                // Рисоват Картинку
                if(!sprite1 || !sprite2 || !sprite3 || !sprite4) {
                    return
                }

                container.rotation = timestamp / 10000
                container1.rotation =  timestamp / 5000
                sprite1.rotation =  - timestamp / 5000
                sprite2.rotation = - timestamp / 3000
                sprite4.rotation = - timestamp / 7000
                // sprite3.rotation = 0


               // Изменяем внутренние пареметръй sprite y фрейма по координату 
                // sprite.frame.x = sprite.textura
                //     .width / 2 + 200 * Math.cos(timestamp / 200)
                // sprite.frame.y = sprite.textura
                //     .height / 2 + 200 * Math.sin(timestamp / 200)

                // sprite.x = renderer.canvas
                //     .width / 2 + 200 * Math.cos(timestamp / 200)
                // sprite.y = renderer.canvas
                //     .height / 2 + 200 * Math.sin(timestamp / 200)
            }
        })

        // Добавляем на существующую страницу тот самой елемент каторъй мъй создали
        document.body.append(renderer.canvas)
        // Добавляем изображения в очеред каким даннъй надо згрузит с сервера
        loader.addImage('bunny', 'static/bunny.jpeg')
        loader.addImage('newbunny', 'static/newbunny.jpeg')
        // loader.addImage('newbunny', 'static/newbunny.jpeg')
        loader.addImage('tank', 'static/tank.png')
        
        // Добавляем json
        loader.addJson('persons', 'static/persons.json')
        // Метод загрузка изображения  асинхронна и сразу въйводит
        loader.load( () => {
            // Стартовая инициализация sprite и передаем в качестве 
            // аргументе изображение
            sprite1 = new Sprite ( loader.getImage('bunny'), {
                // Помешаем в самой центр картинке
                x: -1.2 ,
                y: -1.5 ,
                // rotation: Math.PI / 2,
                // Уменшаем размер Image
                scale: 0.75,
                anchorX: 0.2,
                anchorY: 0.2
            })

            sprite2 = new Sprite ( loader.getImage('bunny'), {
                // Помешаем в самой центр картинке
                x: - 0.1,
                y: -1.5 ,
                // rotation: Math.PI / 2,
                // Уменшаем размер Image
                scale: 0.75,
                anchorX: 0.2,
                anchorY: 0.2
            })

            sprite3 = new Sprite ( loader.getImage('newbunny'), {
                // Помешаем в самой центр картинке
                x: 0.6 ,
                y: 1 ,
                // rotation: Math.PI / 2,
                // Уменшаем размер Image
                scale: 0.20 ,
                anchorX: 0.2,
                anchorY: 0.2
            })
            sprite4 = new Sprite ( loader.getImage('tank'), {
                // Помешаем в самой центр картинке
                x: - 0.5 ,
                y: 1 ,
                // rotation: Math.PI / 2,
                // Уменшаем размер Image
                scale: 0.20 ,
                anchorX: 0.2,
                anchorY: 0.2
            })

            // Создайем нов контейнер
            container = new Container () 
            // Передвигаем canvas
            // container.x = 100
            // container.y = 100
            // container.rotation = Math.PI / 4
            // container.anchorX = 0.5
            // container.anchorY = 0.5
            // Для янкоре нужно убедится что у контейнере есть ширина и въйсата
            container.width = renderer.canvas.width
            container.height = renderer.canvas.height
            // Добавляем container в stage kaтoрой тоже являеться контейнером
                renderer.stage.add(container)
            // Добавляем sprite в container 
                container.add(sprite1)
                container.add(sprite2)


            container1 = new Container ()

            container1.x = 200
            container1.y = 200
            // Для янкоре нужно убедится что у контейнере есть ширина и въйсата
            container1.width = renderer.canvas.width
            container1.height = renderer.canvas.height
            // Добавляем container в stage kaтoрой тоже являеться контейнером
            renderer.stage.add(container1)
             // Добавляем sprite в container 
             container1.add(sprite3)
             container1.add(sprite4)

            // Добавляем sprite в stage
            // renderer.stage.add(sprite)

            // Что бъй вес изображение появляеться на canvas
            // sprite.absoluteX = 0
            // sprite.absoluteY = 0

            // Мащаб в абсолютнъйх величине

            // sprite.frame.x = 50
            // sprite.frame.y = 50
            // sprite.frame.width = 200
            // sprite.frame.height = 170

            // sprite.width = 200
            // sprite.height = 170

            // sprite.x = 100
            // sprite.y = 300
            // sprite.width = 100
            // sprite.height = 100
        })
        // Логическа единица нашего приложение
        const mainScene = new Scene({
            // Передадем обект состаящий из несколко методъй
            autoStart: true,
            loading (loader) {
                // Обращение к екземпляру етому классу mainScene
                console.log('loading fired')
            },
            init () {
                console.log('init fired')
            },
            update () {
                console.log('update fired')
            }
        })

        const game = new Game ({
            // Куда нужно установит игру,точка монтирование елемент
            el: document.body,
            width: 500,
            height: 500,
            background: 'green',
            // Передаем набор сценнъй
            scenes: [mainScene]
        })

</script>
</body>
</html>
